<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>8-Bit Computer Simulator</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #2C3E50;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #ECF0F1;
        }
        #computer {
            background-color: #34495E;
            border: 4px solid #2C3E50;
            border-radius: 10px;
            width: 800px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        #screen {
            width: 100%;
            height: 400px;
            background-color: #000;
            border: 2px solid #7F8C8D;
            margin-bottom: 20px;
        }
        .control-panel {
            display: flex;
            justify-content: space-between;
            background-color: #2C3E50;
            padding: 10px;
            border-radius: 5px;
        }
        .register-display {
            display: flex;
            justify-content: space-around;
            background-color: #000;
            color: #00FF00;
            padding: 10px;
            font-family: 'Courier New', monospace;
            margin-top: 10px;
        }
        button {
            background-color: #2ECC71;
            border: none;
            color: #000;
            padding: 5px 10px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #7F8C8D;
            cursor: not-allowed;
        }
        select {
            background-color: #3498DB;
            color: #000;
        }
    </style>
</head>
<body>
    <div id="computer">
        <canvas id="screen"></canvas>
        
        <div class="control-panel">
            <select id="program-selector">
                <option value="">Select Program</option>
                <option value="simple-graphics">Simple Graphics</option>
                <option value="pixel-draw">Pixel Drawing</option>
                <option value="sprite-move">Sprite Movement</option>
            </select>
            
            <div>
                <button id="load-btn">LOAD</button>
                <button id="run-btn">RUN</button>
                <button id="stop-btn">STOP</button>
            </div>
        </div>
        
        <div class="register-display">
            <div>A: <span id="reg-a">00</span></div>
            <div>X: <span id="reg-x">00</span></div>
            <div>Y: <span id="reg-y">00</span></div>
            <div>PC: <span id="program-counter">00</span></div>
        </div>
    </div>

    <script>
        // 8-Bit Computer Simulator
        class EightBitComputer {
            constructor(screen) {
                this.screen = screen;
                this.ctx = screen.getContext('2d');
                this.memory = new Uint8Array(256);
                this.registers = {
                    A: 0,   // Accumulator
                    X: 0,   // X Index Register
                    Y: 0,   // Y Index Register
                    PC: 0   // Program Counter
                };
                
                // Initialize screen
                screen.width = 256;
                screen.height = 192;
                this.ctx.imageSmoothingEnabled = false;
            }

            // Programs
            programs = {
                'simple-graphics': [
                    0x20, 0x40, 0x00,  // Fill screen with color
                    0x10, 0x80, 0x00,  // Draw pattern
                    0xFF              // End program
                ],
                'pixel-draw': [
                    0x21, 0x50, 0x00,  // Set drawing color
                    0x22, 0x10, 0x20,  // Draw pixel grid
                    0xFF              // End program
                ],
                'sprite-move': [
                    0x23, 0x00, 0x00,  // Initialize sprite position
                    0x24, 0x01, 0x02,  // Move sprite
                    0xFF              // End program
                ]
            };

            loadProgram(programName) {
                const program = this.programs[programName];
                if (!program) return false;

                // Reset registers
                this.registers.A = 0;
                this.registers.X = 0;
                this.registers.Y = 0;
                this.registers.PC = 0;

                // Load program into memory
                this.memory.set(program, 0);
                return true;
            }

            executeInstruction() {
                const opcode = this.memory[this.registers.PC];
                
                switch(opcode) {
                    case 0x20: // Fill screen
                        this.ctx.fillStyle = `rgb(${this.memory[this.registers.PC + 1]}, 0, 0)`;
                        this.ctx.fillRect(0, 0, this.screen.width, this.screen.height);
                        this.registers.PC += 2;
                        break;
                    
                    case 0x21: // Set drawing color
                        this.registers.A = this.memory[this.registers.PC + 1];
                        this.registers.PC += 2;
                        break;
                    
                    case 0x22: // Draw pixel grid
                        for (let x = 0; x < this.screen.width; x += 16) {
                            for (let y = 0; y < this.screen.height; y += 16) {
                                this.ctx.fillStyle = `rgb(${this.registers.A}, 0, 0)`;
                                this.ctx.fillRect(x, y, 16, 16);
                            }
                        }
                        this.registers.PC += 2;
                        break;
                    
                    case 0x23: // Initialize sprite position
                        this.registers.X = this.memory[this.registers.PC + 1];
                        this.registers.Y = this.memory[this.registers.PC + 2];
                        this.registers.PC += 2;
                        break;
                    
                    case 0x24: // Move sprite
                        this.registers.X += this.memory[this.registers.PC + 1];
                        this.registers.Y += this.memory[this.registers.PC + 2];
                        this.registers.PC += 2;
                        break;
                    
                    case 0xFF: // End program
                        return false;
                }
                
                this.registers.PC++;
                return true;
            }

            updateRegisterDisplay() {
                document.getElementById('reg-a').textContent = 
                    this.registers.A.toString(16).padStart(2, '0').toUpperCase();
                document.getElementById('reg-x').textContent = 
                    this.registers.X.toString(16).padStart(2, '0').toUpperCase();
                document.getElementById('reg-y').textContent = 
                    this.registers.Y.toString(16).padStart(2, '0').toUpperCase();
                document.getElementById('program-counter').textContent = 
                    this.registers.PC.toString(16).padStart(2, '0').toUpperCase();
            }
        }

        // Setup
        const screen = document.getElementById('screen');
        const computer = new EightBitComputer(screen);
        
        let runInterval = null;

        // Event Listeners
        document.getElementById('load-btn').addEventListener('click', () => {
            const programSelector = document.getElementById('program-selector');
            const selectedProgram = programSelector.value;
            
            if (computer.loadProgram(selectedProgram)) {
                computer.updateRegisterDisplay();
            }
        });

        document.getElementById('run-btn').addEventListener('click', () => {
            if (runInterval) clearInterval(runInterval);
            
            runInterval = setInterval(() => {
                if (!computer.executeInstruction()) {
                    clearInterval(runInterval);
                }
                computer.updateRegisterDisplay();
            }, 500);
        });

        document.getElementById('stop-btn').addEventListener('click', () => {
            if (runInterval) {
                clearInterval(runInterval);
                runInterval = null;
            }
        });
    </script>
</body>
</html>
